<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Hangzhou 3DGS Proposal v18 (Responsive)</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    
    <style>
        :root {
            --bg-dark: #0f1115;
            --bg-panel: #181b21;
            --accent-primary: #3b82f6;
            --accent-secondary: #10b981;
            --accent-warn: #f59e0b;
            --accent-danger: #ef4444;
            --text-main: #e2e8f0;
            --text-sub: #94a3b8;
            --border-color: #2d3748;
        }

        * { box-sizing: border-box; }

        body { margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background: var(--bg-dark); color: var(--text-main); height: 100vh; display: flex; flex-direction: column; overflow: hidden; }

        /* HEADER */
        header {
            background: #1e293b;
            padding: 15px 25px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            z-index: 100;
            flex-wrap: wrap; /* Allow wrapping on small screens */
            gap: 15px;
        }

        .project-title h1 { margin: 0; font-size: 1.25rem; font-weight: 700; color: #fff; letter-spacing: 0.5px; display: flex; align-items: center; flex-wrap: wrap; gap: 10px; }
        .project-title span { font-size: 0.75rem; color: var(--accent-primary); background: rgba(59, 130, 246, 0.1); padding: 3px 8px; border-radius: 4px; border: 1px solid rgba(59, 130, 246, 0.2); text-transform: uppercase; letter-spacing: 1px; white-space: nowrap; }

        .nav-tabs { display: flex; gap: 8px; background: #0f172a; padding: 4px; border-radius: 8px; border: 1px solid var(--border-color); }
        .tab-btn {
            background: transparent;
            border: none;
            color: var(--text-sub);
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
            font-weight: 500;
            white-space: nowrap;
        }
        .tab-btn:hover { color: #fff; }
        .tab-btn.active { background: var(--accent-primary); color: #fff; box-shadow: 0 1px 3px rgba(0,0,0,0.2); }

        /* MAIN CONTENT */
        main { flex: 1; position: relative; overflow: hidden; }
        .view-section { position: absolute; top: 0; left: 0; right: 0; bottom: 0; overflow-y: auto; display: none; padding: 30px; animation: fadeIn 0.3s ease; -webkit-overflow-scrolling: touch; }
        .view-section.active { display: block; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* --- ASSET LIBRARY --- */
        .intro-text { max-width: 800px; margin: 0 auto 30px auto; text-align: center; color: var(--text-sub); font-size: 0.95rem; line-height: 1.6; }

        .category-section { margin-bottom: 40px; }
        .category-title { font-size: 1.1rem; color: var(--accent-primary); margin-bottom: 15px; display: flex; align-items: center; border-bottom: 1px solid var(--border-color); padding-bottom: 10px; }
        .category-title::before { content: ''; display: inline-block; width: 6px; height: 18px; background: var(--accent-primary); margin-right: 10px; border-radius: 2px; }

        /* Responsive Grid */
        .grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); 
            gap: 20px; 
        }

        .asset-card {
            background: var(--bg-panel);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
            transition: transform 0.2s, border-color 0.2s;
            display: flex;
            flex-direction: column;
        }
        .asset-card:hover { transform: translateY(-3px); border-color: var(--accent-primary); }

        .card-header-row {
            padding: 15px;
            background: rgba(255,255,255,0.02);
            border-bottom: 1px solid var(--border-color);
        }
        .card-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; }
        .card-title { font-weight: 700; color: #fff; margin: 0; font-size: 1.05rem; }
        
        .district-badge { 
            font-size: 0.75rem; 
            background: #1e293b; 
            color: #94a3b8; 
            padding: 2px 8px; 
            border-radius: 4px; 
            border: 1px solid #334155;
            white-space: nowrap;
        }

        .card-sub-row { display: flex; justify-content: space-between; align-items: center; }
        .card-type { font-size: 0.75rem; color: var(--text-sub); text-transform: uppercase; letter-spacing: 0.5px; }
        
        .dist-tag { font-size: 0.7rem; font-weight: bold; padding: 2px 6px; border-radius: 3px; }
        .dist-near { color: var(--accent-secondary); background: rgba(16, 185, 129, 0.1); }
        .dist-mid { color: var(--accent-warn); background: rgba(245, 158, 11, 0.1); }
        .dist-far { color: var(--accent-danger); background: rgba(239, 68, 68, 0.1); }

        /* STAR RATING */
        .star-rating { font-size: 0.8rem; color: #fbbf24; letter-spacing: 2px; display: block; margin-top: 4px; }

        .card-body { padding: 15px; flex: 1; display: flex; flex-direction: column; }
        .tech-spec { margin-bottom: 12px; font-size: 0.9rem; color: #cbd5e1; }
        .tech-spec strong { color: var(--accent-secondary); font-weight: normal; }
        
        .reason-box {
            background: rgba(59, 130, 246, 0.05);
            border-left: 3px solid var(--accent-primary);
            padding: 10px;
            font-size: 0.85rem;
            color: #94a3b8;
            margin-bottom: 15px;
            line-height: 1.5;
            flex: 1;
        }

        .action-row { display: flex; gap: 10px; margin-top: auto; }
        .btn-link {
            flex: 1;
            padding: 10px 0;
            text-align: center;
            border-radius: 4px;
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            transition: 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }
        .btn-google { background: #2d3748; color: #e2e8f0; border: 1px solid #4a5568; }
        .btn-google:hover { background: #4a5568; color: #fff; }
        .btn-map { background: transparent; color: var(--accent-primary); border: 1px solid var(--accent-primary); }
        .btn-map:hover { background: rgba(59, 130, 246, 0.1); }

        /* --- ITINERARY --- */
        .timeline-container { max-width: 900px; margin: 0 auto; }
        .day-block {
            background: var(--bg-panel);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            margin-bottom: 25px;
            position: relative;
            overflow: hidden;
        }
        .day-block.fixed { border-left: 4px solid var(--accent-secondary); } 
        .day-block.tbd { border-left: 4px solid #f59e0b; border-style: dashed; } 
        .day-block.free { border-left: 4px solid #3b82f6; } 
        .day-block.buffer { border-left: 4px solid #8b5cf6; } 

        .day-padding { padding: 20px; }

        .day-header { display: flex; justify-content: space-between; margin-bottom: 15px; border-bottom: 1px solid var(--border-color); padding-bottom: 10px; align-items: center; }
        .day-num { font-weight: 700; color: #fff; font-size: 1.1rem; }
        .day-status { font-size: 0.8rem; padding: 2px 8px; border-radius: 4px; font-weight: 600; white-space: nowrap; }
        .status-fixed { background: rgba(16, 185, 129, 0.1); color: var(--accent-secondary); }
        .status-select { background: rgba(245, 158, 11, 0.1); color: #f59e0b; }
        .status-free { background: rgba(59, 130, 246, 0.1); color: var(--accent-primary); }
        .status-buffer { background: rgba(139, 92, 246, 0.1); color: #a78bfa; }

        /* COMMUTE METER */
        .meter-wrapper {
            background: rgba(0,0,0,0.3);
            padding: 10px 20px;
            border-top: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .meter-bar { flex: 1; height: 8px; background: #333; border-radius: 4px; overflow: hidden; }
        .meter-fill { height: 100%; border-radius: 4px; transition: width 0.5s ease; }
        .meter-label { font-size: 0.8rem; color: #ccc; font-family: monospace; white-space: nowrap; width: 150px; text-align: right; font-weight: bold; }

        .time-slot { display: flex; margin-bottom: 12px; }
        .ts-time { width: 60px; font-family: monospace; color: var(--text-sub); font-size: 0.9rem; padding-top: 2px; flex-shrink: 0; }
        .ts-content { flex: 1; }
        .ts-title { font-weight: 600; color: #e2e8f0; margin-bottom: 4px; }
        .ts-desc { font-size: 0.9rem; color: #94a3b8; line-height: 1.5; }
        .ts-assets { margin-top: 6px; display: flex; gap: 6px; flex-wrap: wrap; }
        .asset-tag { font-size: 0.75rem; background: #1e293b; color: var(--accent-primary); padding: 2px 8px; border-radius: 4px; border: 1px solid #334155; }
        
        .empty-slot { border: 2px dashed #444; border-radius: 12px; padding: 30px; text-align: center; color: #666; transition: 0.3s; }
        .empty-slot:hover { border-color: var(--accent-primary); color: #fff; background: rgba(59, 130, 246, 0.05); }
        .empty-slot h3 { margin: 0 0 10px 0; font-size: 1.1rem; }

        /* --- MAP --- */
        #map-view { padding: 0; }
        #map { width: 100%; height: 100%; }
        .map-label { background: transparent !important; border: none !important; box-shadow: none !important; color: #fff !important; font-weight: bold; font-size: 14px; text-shadow: 2px 2px 4px #000; }

        /* --- RESPONSIVE MEDIA QUERIES (NEW) --- */
        @media (max-width: 768px) {
            header { flex-direction: column; align-items: stretch; padding: 15px; }
            .nav-tabs { justify-content: space-between; overflow-x: auto; -webkit-overflow-scrolling: touch; }
            .tab-btn { flex: 1; padding: 8px 10px; font-size: 0.8rem; }
            
            .view-section { padding: 15px; }
            .grid { grid-template-columns: 1fr; } /* Stack cards on mobile */
            
            .day-header { flex-direction: column; align-items: flex-start; gap: 8px; }
            .time-slot { flex-direction: column; }
            .ts-time { width: 100%; margin-bottom: 4px; color: var(--accent-primary); font-weight: bold; }
            
            .meter-wrapper { flex-direction: column; gap: 5px; align-items: flex-start; }
            .meter-bar { width: 100%; }
            .meter-label { width: 100%; text-align: left; font-size: 0.75rem; }
            
            .action-row { flex-direction: column; }
        }

    </style>
</head>
<body>

<header>
    <div class="project-title">
        <h1>Hangzhou 3DGS Shooting Plan <span>Proposal</span></h1>
    </div>
    <div class="nav-tabs">
        <button class="tab-btn active" onclick="switchView('assets')">1. ÈÅ∏È†ÖÂ∫´</button>
        <button class="tab-btn" onclick="switchView('itinerary')">2. Ë°åÁ®ãË°®</button>
        <button class="tab-btn" onclick="switchView('map')">3. Âú∞Âúñ</button>
    </div>
</header>

<main>
    <div id="view-assets" class="view-section active">
        <div class="intro-text">
            <p>Êú¨ÊèêÊ°àÊó®Âú®Âà©Áî® 3D Gaussian Splatting ÊäÄË°ìÊï∏‰ΩçÂåñ‰øùÂ≠òÊù≠Â∑ûË¢´ÂøΩË¶ñÁöÑÊñáÂåñÈÅ∫Áî¢„ÄÇ‰ª•‰∏ãÂÄôÈÅ∏Âú∞ÈªûÂ∑≤Ê†πÊìö<b>ÊùêË≥™Á¥ãÁêÜ</b>„ÄÅ<b>Âπæ‰ΩïË§áÈõúÂ∫¶</b>Âèä<b>Â≠∏Ë°ì‰øùÂ≠òÂÉπÂÄº</b>ÈÄ≤Ë°åË©ï‰º∞Ôºå‰∏¶Ê®ôË®ªÊé®Ëñ¶Â∫¶ÔºàRatingÔºâ„ÄÇ</p>
        </div>

        <div id="assets-container">
            </div>
    </div>

    <div id="view-itinerary" class="view-section">
        <div class="timeline-container" id="itinerary-container">
            </div>
    </div>

    <div id="view-map" class="view-section" id="map-view">
        <div id="map"></div>
    </div>
</main>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

<script>
    // --- DATA: ASSET LIBRARY (Final Rated) ---
    const assetCategories = [
        {
            id: "core",
            title: "Ê†∏ÂøÉÂøÖÈÅ∏ (Technical Benchmarks)",
            items: [
                {
                    name: "È¶ôÁ©çÂØ∫",
                    area: "Êã±Â¢ÖÂçÄ",
                    dist: "near",
                    distText: "Â∏ÇÂçÄÊ†∏ÂøÉ",
                    type: "ÈáëÂ±¨ÊùêË≥™ / Âª∫ÁØâ",
                    rating: 5,
                    spec: "È´òÂèçÂÖâÈäÖÊÆø + Ë§áÈõúÊñóÊã±",
                    reason: "„Äê5ÊòüÊé®Ëñ¶„ÄëÊ∏¨Ë©¶ 3DGS Â∞çÈáëÂ±¨Ê∞ßÂåñÁ¥ãÁêÜ (Patina) ÂèäÂêÑÂêëÁï∞ÊÄßÂèçÂ∞ÑÁöÑÈÇÑÂéüËÉΩÂäõ„ÄÇÊúÄÈáçË¶ÅÁöÑÂü∫Ê∫ñÈªû„ÄÇ",
                    query: "Êù≠Â∑ûÈ¶ôÁ©çÂØ∫",
                    lat: 30.296, lng: 120.147
                }
            ]
        },
        {
            id: "structure",
            title: "Âª∫ÁØâÁµêÊßãËàáÂπæ‰Ωï (Geometry)",
            items: [
                {
                    name: "ÊÖßÂõ†È´òÈ∫óÂØ∫",
                    area: "Ë•øÊπñÂçÄ",
                    dist: "mid",
                    distText: "ÊôØÂçÄ (ÊòìÂ†µ)",
                    type: "Êú®Êßã / ÂÆ§ÂÖß",
                    rating: 4,
                    spec: "13.6Á±≥Ê•†Êú®ËΩâËº™Ëóè + ÂÆãÂºèÁ¥ÖÁâÜ",
                    reason: "„Äê4ÊòüÊé®Ëñ¶„ÄëÂÖ®Êù≠Â∑ûÊúÄÂÆâÈùúÁöÑÂØ∫Âªü„ÄÇÊåëÊà∞ÂÆ§ÂÖßË§áÈõúÊú®ÁµêÊßãÁöÑÈ´òÁ≤æÂ∫¶ÈáçÂª∫ÔºåÈúÄËß£Ê±∫ÂÖâÁÖß‰∏çË∂≥ÂïèÈ°å„ÄÇ",
                    query: "ÊÖßÂõ†È´òÈ∫óÂØ∫",
                    lat: 30.228, lng: 120.125
                },
                {
                    name: "ÂæëÂ±±ÂØ∫",
                    area: "È§òÊù≠ÂçÄ",
                    dist: "far",
                    distText: "ÈÅ†ÈÉä (1hr+)",
                    type: "Â§ßÂ†¥ÊôØ / Â∞çÁ®±",
                    rating: 4,
                    spec: "ÂÆã‰ª£Ê•µÁ∞°È¢®Ê†º + ‰∏≠Ëª∏Á∑ö‰ΩàÂ±Ä",
                    reason: "„Äê4ÊòüÊé®Ëñ¶„ÄëÊó•Êú¨Á¶™Èô¢ÈºªÁ•ñ„ÄÇÂª∫ÁØâÂ∞∫Â∫¶Â§ßÔºåÈÅ©ÂêàÂà©Áî®ÁÑ°‰∫∫Ê©üÊ∏¨Ë©¶Â∞çÁ®±Âª∫ÁØâÁæ§ÁöÑ‰∏âÁ∂≠ÈáçÂª∫„ÄÇ",
                    query: "ÂæëÂ±±Ëê¨Â£ΩÁ¶™ÂØ∫",
                    lat: 30.380, lng: 119.855
                },
                {
                    name: "ËÉ°ÊÖ∂È§òÂ†Ç",
                    area: "‰∏äÂüéÂçÄ",
                    dist: "near",
                    distText: "Â∏ÇÂçÄ (Ê≤≥ÂùäË°ó)",
                    type: "ÊôöÊ∏ÖÂª∫ÁØâ / ÁôΩÁâÜ",
                    rating: 4,
                    spec: "È´òËÅ≥ÁôΩÁâÜ + Â∞ÅÁÅ´ÁâÜ + Ëó•Â±ÄÊ†ºÂ±Ä",
                    reason: "„Äê4ÊòüÊé®Ëñ¶„Äë„ÄéÊ±üÂçóËó•Áéã„Äè„ÄÇÂÖ∏ÂûãÁöÑÈ´òÁâÜÁ™ÑÂ∑∑ÁµêÊßãÔºåÁôΩËâ≤ÁâÜÈù¢Â∞çÁâπÂæµÈªûÊèêÂèñÊúâ‰∏ÄÂÆöÊåëÊà∞ÊÄß„ÄÇ",
                    query: "Êù≠Â∑ûËÉ°ÊÖ∂È§òÂ†Ç",
                    lat: 30.238, lng: 120.168
                },
                {
                    name: "Â∞èÊ≤≥ÂÖ¨Âúí",
                    area: "Êã±Â¢ÖÂçÄ",
                    dist: "near",
                    distText: "Â∏ÇÂçÄ",
                    type: "Â∑•Ê•≠ÈÅ∫Â≠ò",
                    rating: 3,
                    spec: "ÈäπË∑°Ê≤πÁΩê + Á∂≤ÁãÄÈõ≤Ê£ö",
                    reason: "„Äê3ÊòüÊé®Ëñ¶„ÄëÈñãÊîæÂºèÂ†¥Âú∞„ÄÇÈÅ©ÂêàÊ∏¨Ë©¶Á¥∞Áµ≤ÁµêÊßãËàáÈáëÂ±¨ÈäπË∑°„ÄÇÁµêÊßãÁõ∏Â∞çÁ∞°ÂñÆÔºå‰ΩúÁÇ∫Ë£úÂÖÖÁ¥†Êùê„ÄÇ",
                    query: "Êù≠Â∑ûÂ∞èÊ≤≥ÂÖ¨Âúí",
                    lat: 30.315, lng: 120.135
                }
            ]
        },
        {
            id: "town",
            title: "Âè§ÈéÆËÇåÁêÜ (Ancient Texture)",
            items: [
                {
                    name: "Ê∑±Êæ≥Âè§Êùë",
                    area: "Ê°êÂª¨Á∏£",
                    dist: "far",
                    distText: "ÈÅ†ÈÉä (1.5hr+)",
                    type: "Ê∞¥Á≥ª / ÂæΩÊ¥æ",
                    rating: 5,
                    spec: "Âú∞‰∏ãÂùéÂÖí‰∫ï + È¶¨È†≠ÁâÜÁü©Èô£",
                    reason: "„Äê5ÊòüÊé®Ëñ¶„ÄëÁç®ÊúâÁöÑÁç®Á´ãÂú∞‰∏ãÊ∞¥Á≥ª„ÄÇÈ´òÂØÜÂ∫¶ÁöÑÈ¶¨È†≠ÁâÜÈùûÂ∏∏ÈÅ©ÂêàÁÑ°‰∫∫Ê©ü‰∏äÂ∏ùË¶ñËßíÊéÉÊèèÔºåÂπæ‰ΩïË±êÂØå„ÄÇ",
                    query: "Ê°êÂª¨Ê∑±Êæ≥Âè§Êùë",
                    lat: 29.835, lng: 119.820
                },
                {
                    name: "ÈæçÈñÄÂè§ÈéÆ",
                    area: "ÂØåÈôΩÂçÄ",
                    dist: "far",
                    distText: "ÈÅ†ÈÉä (1hr+)",
                    type: "Ëø∑ÂÆÆ / Áü≥Êùê",
                    rating: 4,
                    spec: "ÈµùÂçµÁü≥ÁâÜÈù¢ + Ëø∑ÂÆÆÂ∑∑ÈÅì",
                    reason: "„Äê4ÊòüÊé®Ëñ¶„ÄëÂÖ®ÈéÆÁî±ÈµùÂçµÁü≥Èã™Â∞±ÔºåÊèê‰æõÊ•µÈ´òÈ†ªÁöÑÂπæ‰ΩïÁ¥ãÁêÜ (High-frequency Texture)ÔºåÊ∏¨Ë©¶Á¥∞ÁØÄËß£ÊûêÂ∫¶„ÄÇ",
                    query: "ÂØåÈôΩÈæçÈñÄÂè§ÈéÆ",
                    lat: 30.005, lng: 119.955
                },
                {
                    name: "Â°òÊ£≤Âè§ÈéÆ",
                    area: "Ëá®Âπ≥ÂçÄ",
                    dist: "mid",
                    distText: "ÂüéÂåó (45min)",
                    type: "ÈÅãÊ≤≥ / Ê©ãÊ®ë",
                    rating: 4,
                    spec: "‰∏ÉÂ≠îÂª£ÊøüÊ©ã + Ê∞¥Èù¢ÂÄíÂΩ±",
                    reason: "„Äê4ÊòüÊé®Ëñ¶„ÄëÂèØÊ∏¨Ë©¶ 3DGS Â∞çÊ∞¥Èù¢ÂèçÂ∞Ñ (Water Reflection) ÁöÑËôïÁêÜÊïàÊûú„ÄÇÂè§Ê©ãÂπæ‰ΩïÁµêÊßãÂÑ™Áæé„ÄÇ",
                    query: "Â°òÊ£≤Âè§ÈéÆ",
                    lat: 30.435, lng: 120.190
                },
                {
                    name: "Ë•øËààÂè§ÈéÆ",
                    area: "Êø±Ê±üÂçÄ",
                    dist: "near",
                    distText: "Â∏ÇÂçÄ",
                    type: "Â∏Ç‰∫ï / Êú®Êßã",
                    rating: 3,
                    spec: "ÈÅéÂ°òË°åËÄÅÂ±ã + ÁáàÁ±†Â∑•Ëóù",
                    reason: "„Äê3ÊòüÊé®Ëñ¶„ÄëÈÅãÊ≤≥Ê∫êÈ†≠„ÄÇÈÅ©ÂêàÊçïÊçâÁúüÂØ¶ÁöÑÁîüÊ¥ªÁóïË∑°ËàáËÄÅÂåñÊú®ÊùêÁ¥ãÁêÜÔºå‰ΩúÁÇ∫Day 1ÁÜ±Ë∫´„ÄÇ",
                    query: "Êù≠Â∑ûË•øËààÂè§ÈéÆ",
                    lat: 30.180, lng: 120.230
                }
            ]
        },
        {
            id: "nature",
            title: "ÈõïÂàªËàáÂúíÊûó (Sculpture & Gardens)",
            items: [
                {
                    name: "È£õ‰æÜÂ≥∞ÈÄ†ÂÉè",
                    area: "Ë•øÊπñÂçÄ",
                    dist: "mid",
                    distText: "ÈùàÈö±ÊôØÂçÄ",
                    type: "Áü≥Á™ü / ÈõïÂàª",
                    rating: 5,
                    spec: "‰∫î‰ª£Ëá≥ÂÖÉ‰ª£Áü≥Âàª + Ë§áÈõúÂ≤©Áü≥Ë°®Èù¢",
                    reason: "„Äê5ÊòüÊé®Ëñ¶„ÄëÁü≥Á™üÈÄ†ÂÉèÂÖ∑ÊúâÊ•µÈ´òÁöÑÊ≠∑Âè≤ÂÉπÂÄºËàáË§áÈõúÂπæ‰ΩïË°®Èù¢ÔºåÊòØ Photogrammetry/3DGS ÁöÑÈ†ÇÁ¥öÁ¥†Êùê„ÄÇ",
                    query: "Êù≠Â∑ûÈ£õ‰æÜÂ≥∞ÈÄ†ÂÉè",
                    lat: 30.239, lng: 120.105
                },
                {
                    name: "ÂÖ≠ÂíåÂ°î",
                    area: "Ë•øÊπñÂçÄ",
                    dist: "mid",
                    distText: "Èå¢Â°òÊ±üÁïî",
                    type: "Á£öÊú®ÁµêÊßã / Â°î",
                    rating: 5,
                    spec: "13Â±§ÂÖ´ËßíÁµêÊßã + Ëû∫ÊóãÈöéÊ¢Ø",
                    reason: "„Äê5ÊòüÊé®Ëñ¶„ÄëÂ∑®Â§ßÁöÑÈ´îÈáèËàáÈáçË§áÁöÑÂπæ‰ΩïÂ±§Ê¨°ÔºåÁµêÊßãÂÖßÂ§ñÁöÜÂèØÊéÉÊèèÔºåÊ™¢È©óÁµêÊßã‰∏ÄËá¥ÊÄßÁöÑÂÆåÁæéÁõÆÊ®ô„ÄÇ",
                    query: "Êù≠Â∑ûÂÖ≠ÂíåÂ°î",
                    lat: 30.196, lng: 120.129
                },
                {
                    name: "ÈÉ≠Ëéä",
                    area: "Ë•øÊπñÂçÄ",
                    dist: "mid",
                    distText: "Ë•øÊπñÈÇä",
                    type: "Ê±üÂçóÂúíÊûó",
                    rating: 4,
                    spec: "Ê∞¥Ê¶≠ + ÂÅáÂ±± + ‰∫≠Âè∞",
                    reason: "„Äê4ÊòüÊé®Ëñ¶„ÄëÂúíÊûóÁµêÊßãË§áÈõúÔºåÂ≠òÂú®Â§ßÈáèÈÅÆÊìã (Occlusion) ËàáÈÄèË¶ñÈóú‰øÇÔºåÊòØÊ∏¨Ë©¶ÊºîÁÆóÊ≥ïÂº∑ÂÅ•ÊÄßÁöÑÂ•ΩÂú∞Êñπ„ÄÇ",
                    query: "Êù≠Â∑ûÈÉ≠Ëéä",
                    lat: 30.245, lng: 120.128
                },
                {
                    name: "ÁôΩÂ°îÂÖ¨Âúí",
                    area: "‰∏äÂüéÂçÄ",
                    dist: "near",
                    distText: "Â∏ÇÂçÄ",
                    type: "ÈêµË∑Ø / Áü≥Â°î",
                    rating: 3,
                    spec: "Ëí∏Ê±ΩÁÅ´ËªäÈ†≠ + ‰∫î‰ª£Áü≥Â°î",
                    reason: "„Äê3ÊòüÊé®Ëñ¶„ÄëÂ†¥Âú∞Á©∫Êõ†ÔºåÁÑ°‰∫∫Ê©üÈ£õË°åÈ¢®Èö™‰Ωé„ÄÇÁµêÂêà‰∫ÜÁü≥Ë≥™ÊñáÁâ©ËàáÂ∑•Ê•≠Ê©üÊ¢∞ÂÖ©Á®ÆÊùêË≥™„ÄÇ",
                    query: "Êù≠Â∑ûÁôΩÂ°îÂÖ¨Âúí",
                    lat: 30.195, lng: 120.145
                }
            ]
        }
    ];

    // --- DATA: ITINERARY PLAN ---
    const itineraryData = [
        {
            day: "Day 1",
            status: "fixed",
            label: "ÊäµÈÅîËàáÈÅ©Êáâ",
            commuteLevel: 10,
            commuteText: "ÈÄöÂã§Ôºö‰Ωé (Â∏ÇÂçÄ)",
            events: [
                { time: "12:00", title: "ÊäµÈÅîÊù≠Â∑û", desc: "ÂÖ•‰ΩèÈÖíÂ∫ó (Âª∫Ë≠∞ÈÅ∏ÂùÄÔºö‰∫§ÈÄöÊ®ûÁ¥êÈôÑËøë)„ÄÇ", assets: [] },
                { time: "14:00", title: "Ë•øËààÂè§ÈéÆ (Êé®Ëñ¶)", desc: "Âú∞ÈªûÂ∞±Âú®Â∏ÇÂçÄÊø±Ê±üÂçÄÔºå‰∫∫ÊµÅÁ®ÄÂ∞ë„ÄÇ‰ΩúÁÇ∫Âô®ÊùêÊ∏¨Ë©¶ËàáÁÑ°‰∫∫Ê©üË©¶È£õÁöÑÈ¶ñÁ´ô„ÄÇÊãçÊîù„ÄåÈÅéÂ°òË°å„ÄçËàäÂùÄ„ÄÇ", assets: ["Êú®Ë≥™ËÄÅÂåñ", "ÁîüÊ¥ªÂ†¥ÊôØ"] }
            ]
        },
        {
            day: "Day 2",
            status: "fixed",
            label: "Ê†∏ÂøÉ‰ªªÂãô (Core Mission)",
            commuteLevel: 30,
            commuteText: "ÈÄöÂã§Ôºö‰Ωé (Êã±Â¢ÖÂçÄ)",
            events: [
                { time: "06:30", title: "È¶ôÁ©çÂØ∫", desc: "ÂÖ®Â¢ÉÊéÉÊèè„ÄÇÂà©Áî®Ê∏ÖÊô®ÂÖâÁ∑öÊãçÊîùÈäÖÊÆø„ÄÅËø¥ÂªäËàáÈºìÊ®ì„ÄÇÈÄôÊòØÊú¨Â∞àÊ°àÁöÑ„ÄåÂü∫Ê∫ñÊ∏¨Ë©¶Â†¥ÊôØ„Äç„ÄÇ", assets: ["ÈäÖÊÆø(Metal)", "HelixÈÅãÈè°"] },
                { time: "14:00", title: "Âë®ÈÇäÂ∑•Ê•≠ÈÅ∫Â≠ò (ÂèØÈÅ∏)", desc: "Âª∫Ë≠∞ÂâçÂæÄÈôÑËøëÁöÑÂ∞èÊ≤≥ÂÖ¨Âúí (Êã±Â¢ÖÂçÄ)ÔºåÊéÉÊèèÊ≤πÁΩêËàáÈãºÁµêÊßãÔºåËàáÊó©‰∏äÁöÑÂè§ÂÖ∏Âª∫ÁØâÂΩ¢ÊàêÊùêË≥™Â∞çÊØî„ÄÇ", assets: ["Â∑•Ê•≠ÈäπË∑°"] },
                { time: "20:00", title: "Êï∏Êìö QA Ê™¢Êü•", desc: "Ê™¢Êü•Áï∂Êó•Á¥†ÊùêË¶ÜËìãÁéáÔºåÁ¢∫Ë™çÁÑ°Â±ãÈ†ÇÁ†¥Ê¥û„ÄÇ", assets: [] }
            ]
        },
        {
            day: "Day 3",
            status: "tbd",
            label: "ÂæÖÂÆöÔºöÈÅ†ÈÉäÂè§ÈéÆËÄÉÂØü",
            commuteLevel: 90,
            commuteText: "ÈÄöÂã§ÔºöÈ´ò (ÂæÄËøî3hr+)",
            isBlank: true,
            desc: "Âª∫Ë≠∞ÂÆâÊéíÔºöÊ∑±Êæ≥Âè§Êùë (5Êòü/Ê∞¥Á≥ª) Êàñ ÈæçÈñÄÂè§ÈéÆ (4Êòü/Ëø∑ÂÆÆ)„ÄÇÂùáÈúÄÈï∑ÈÄî‰∫§ÈÄöÔºåÂª∫Ë≠∞ÂåÖËªä„ÄÇ"
        },
        {
            day: "Day 4",
            status: "tbd",
            label: "ÂæÖÂÆöÔºöÂª∫ÁØâËàáÈõïÂàª",
            commuteLevel: 60,
            commuteText: "ÈÄöÂã§Ôºö‰∏≠",
            isBlank: true,
            desc: "Âª∫Ë≠∞ÂÆâÊéíÔºöÈ£õ‰æÜÂ≥∞ÈÄ†ÂÉè (5Êòü/Áü≥Á™üÁ¥∞ÁØÄ) Êàñ ÂÖ≠ÂíåÂ°î (5Êòü/Â∑®ÂûãÂè§Â°î)„ÄÇ"
        },
        {
            day: "Day 5",
            status: "tbd",
            label: "ÂæÖÂÆöÔºöË•øÊπñÈö±ÁßòËßíËêΩ",
            commuteLevel: 50,
            commuteText: "ÈÄöÂã§Ôºö‰∏≠ (ÊôØÂçÄÂ†µËªä)",
            isBlank: true,
            desc: "Âª∫Ë≠∞ÂÆâÊéíÔºöÊÖßÂõ†È´òÈ∫óÂØ∫ (4Êòü/ÂÆ§ÂÖß) Êàñ ÈÉ≠Ëéä (4Êòü/ÂúíÊûóÁµêÊßã)„ÄÇÈúÄÊ•µÊó©Âá∫ÁôºÈÅøÈñãÈÅäÂÆ¢„ÄÇ"
        },
        {
            day: "Day 6",
            status: "fixed",
            type: "free",
            label: "Ëá™Áî±Ê¥ªÂãïÊó• (Free Day)",
            commuteLevel: 0,
            commuteText: "ÈÄöÂã§ÔºöËá™Ë°åÂÆâÊéí",
            events: [
                { time: "ÂÖ®Â§©", title: "Ëá™Áî±Êé¢Á¥¢ / ÂüéÂ∏ÇÊº´ÈÅä", desc: "ÂèØËá™Áî±ÂâçÂæÄË•øÊπñÂë®ÈÇäÈÅäË¶ΩÔºåÊàñÈáùÂ∞çÊÑüËààË∂£ÁöÑÂçÄÂüüÈÄ≤Ë°åÈ°çÂ§ñËÄÉÂØü (Â¶ÇÁôΩÂ°îÂÖ¨Âúí)„ÄÇ", assets: ["Free Exploration"] },
                { time: "20:00", title: "Êï∏ÊìöÊï¥ÁêÜ", desc: "Êï¥ÁêÜÂâçÂπæÊó•ÁöÑÊéÉÊèèÊï∏ÊìöÔºåÊ∫ñÂÇôÊúÄÁµÇÂåØÂ†±Á¥†Êùê„ÄÇ", assets: ["Data Org"] }
            ]
        },
        {
            day: "Day 7",
            status: "fixed",
            type: "buffer",
            label: "Ê©üÂãïË£úÊãçÊó• (Buffer Day)",
            commuteLevel: 20,
            commuteText: "ÈÄöÂã§ÔºöË¶ñÂú∞ÈªûËÄåÂÆö",
            events: [
                { time: "09:00", title: "Êï∏Êìö‰øÆÂæ© (Data Recovery)", desc: "Ê†πÊìö D1-D5 ÁöÑ QA Â†±ÂëäÔºåËøîÂõûÊúâÁº∫Èô∑ÁöÑÂú∞Èªû (Â¶ÇÂ±ãÈ†ÇÁ†¥Êêç„ÄÅÊ∞¥Èù¢ÈáçÂª∫Â§±Êïó) ÈÄ≤Ë°åË£úÊãç„ÄÇ", assets: ["Re-shoot"] },
                { time: "14:00", title: "ÂÇôÈÅ∏ËÄÉÂØü", desc: "Ëã•ÊâÄÊúâÊï∏ÊìöÂÆåÁæéÔºåÂèØÂâçÂæÄËÉ°ÊÖ∂È§òÂ†Ç (4Êòü) ÊãçÊîùÂÇ≥Áµ±ÁôΩÁâÜÂª∫ÁØâ„ÄÇ", assets: ["Optional"] }
            ]
        },
        {
            day: "Day 8",
            status: "fixed",
            label: "ÁµêÊ°àËàáËøîÁ®ã",
            commuteLevel: 0,
            commuteText: "ÈÄöÂã§ÔºöÁÑ°",
            events: [
                { time: "10:00", title: "ÊúÄÁµÇÊ™¢Êü•", desc: "Á¢∫Ë™çÊâÄÊúâÁ°¨Á¢üÊï∏ÊìöÂÇô‰ªΩÂÆåÊàê (Primary + Backup)„ÄÇ", assets: [] },
                { time: "14:00", title: "ËøîÁ®ã", desc: "ÂâçÂæÄÊ©üÂ†¥/È´òÈêµÁ´ôÔºåÁµêÊùüË°åÁ®ã„ÄÇ", assets: [] }
            ]
        }
    ];

    // --- RENDER LOGIC ---

    function renderAssets() {
        const container = document.getElementById('assets-container');
        let html = '';

        assetCategories.forEach(cat => {
            let itemsHtml = cat.items.map(item => {
                const googleUrl = `https://www.google.com/search?tbm=isch&q=${encodeURIComponent(item.query)}`;
                const amapUrl = `https://www.amap.com/search?query=${encodeURIComponent(item.query)}&city=330100`;
                
                let distClass = 'dist-near';
                if(item.dist === 'mid') distClass = 'dist-mid';
                if(item.dist === 'far') distClass = 'dist-far';

                // Generate Stars
                let stars = '‚òÖ'.repeat(item.rating) + '‚òÜ'.repeat(5 - item.rating);

                return `
                    <div class="asset-card">
                        <div class="card-header-row">
                            <div class="card-top">
                                <h3 class="card-title">${item.name} <span class="star-rating">${stars}</span></h3>
                                <span class="district-badge">${item.area}</span>
                            </div>
                            <div class="card-sub-row">
                                <span class="card-type">${item.type}</span>
                                <span class="dist-tag ${distClass}">${item.distText}</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="tech-spec"><strong>Ë≥áÁî¢ÁâπÂæµ:</strong> ${item.spec}</div>
                            <div class="reason-box">
                                <strong>3DGS Êé®Ëñ¶ÁêÜÁî±Ôºö</strong>${item.reason}
                            </div>
                            <div class="action-row">
                                <a href="${googleUrl}" target="_blank" class="btn-link btn-google">
                                    üñºÔ∏è ÁúãÁúüÂØ¶ÂúñÁâá
                                </a>
                                <a href="${amapUrl}" target="_blank" class="btn-link btn-map">
                                    üìç È´òÂæ∑Â∞éËà™
                                </a>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            html += `
                <div class="category-section">
                    <div class="category-title">${cat.title}</div>
                    <div class="grid">
                        ${itemsHtml}
                    </div>
                </div>
            `;
        });

        container.innerHTML = html;
    }

    function renderItinerary() {
        const container = document.getElementById('itinerary-container');
        let html = '';

        itineraryData.forEach(day => {
            let statusClass = '';
            let statusText = '';
            let blockClass = '';

            // Status Logic
            if (day.status === 'fixed') {
                statusText = 'Â∑≤ÈéñÂÆö (Fixed)';
                if (day.type === 'free') {
                    statusClass = 'status-free';
                    blockClass = 'fixed free';
                    statusText = 'Ëá™Áî±Ê¥ªÂãï (Free)';
                } else if (day.type === 'buffer') {
                    statusClass = 'status-buffer';
                    blockClass = 'fixed buffer';
                    statusText = 'Ê©üÂãïË£úÊãç (Buffer)';
                } else {
                    statusClass = 'status-fixed';
                    blockClass = 'fixed';
                }
            } else {
                statusClass = 'status-select';
                statusText = 'ÂæÖÈÅ∏Êìá (Selectable)';
                blockClass = 'tbd';
            }

            let contentHtml = '';
            
            if (day.isBlank) {
                // TBD Content
                contentHtml = `
                    <div class="empty-slot">
                        <h3>${day.desc}</h3>
                    </div>
                `;
            } else {
                // Fixed Content
                contentHtml = day.events.map(e => {
                    let tags = e.assets.map(a => `<span class="asset-tag">${a}</span>`).join('');
                    return `
                        <div class="time-slot">
                            <div class="ts-time">${e.time}</div>
                            <div class="ts-content">
                                <div class="ts-title">${e.title}</div>
                                <div class="ts-desc">${e.desc}</div>
                                <div class="ts-assets">${tags}</div>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            // Commute Meter Color Logic
            let commuteLevel = day.commuteLevel || 0;
            let barColor = `linear-gradient(90deg, #10b981, #10b981)`; 
            if(commuteLevel > 40) barColor = `linear-gradient(90deg, #10b981, #f59e0b)`;
            if(commuteLevel > 70) barColor = `linear-gradient(90deg, #10b981, #f59e0b, #ef4444)`;
            if(commuteLevel === 0) barColor = `transparent`; 

            html += `
                <div class="day-block ${blockClass}">
                    <div class="day-padding">
                        <div class="day-header">
                            <div class="day-num">${day.day}: ${day.label}</div>
                            <div class="day-status ${statusClass}">${statusText}</div>
                        </div>
                        ${contentHtml}
                    </div>
                    
                    <div class="meter-wrapper">
                        <div class="meter-bar">
                            <div class="meter-fill" style="width: ${commuteLevel}%; background: ${barColor}"></div>
                        </div>
                        <div class="meter-label">${day.commuteText}</div>
                    </div>
                </div>
            `;
        });

        container.innerHTML = html;
    }

    // Map Logic
    let map = null;
    function initMap() {
        if(map) return;
        map = L.map('map').setView([30.15, 120.00], 9);
        L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
            attribution: '¬© OpenStreetMap ¬© CARTO',
            subdomains: 'abcd',
            maxZoom: 19
        }).addTo(map);

        const allItems = assetCategories.flatMap(cat => cat.items.map(item => ({...item, catId: cat.id})));

        allItems.forEach(item => {
            let color = '#3b82f6';
            if(item.catId === 'core') color = '#ef4444'; 
            if(item.catId === 'town') color = '#f59e0b'; 
            if(item.catId === 'structure') color = '#10b981';

            const icon = L.divIcon({
                className: 'custom-icon',
                html: `<div style="background:${color};width:12px;height:12px;border-radius:50%;border:2px solid #fff;box-shadow:0 0 8px ${color}"></div>`,
                iconSize: [16, 16]
            });

            L.marker([item.lat, item.lng], {icon: icon})
                .addTo(map)
                .bindTooltip(item.name, {
                    permanent: true,
                    direction: 'top',
                    className: 'map-label',
                    offset: [0, -10]
                });
        });
    }

    function switchView(viewId) {
        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
        event.target.classList.add('active');
        document.querySelectorAll('.view-section').forEach(sec => sec.classList.remove('active'));
        document.getElementById(`view-${viewId}`).classList.add('active');

        if(viewId === 'map') {
            setTimeout(() => {
                initMap();
                map.invalidateSize();
                const allItems = assetCategories.flatMap(cat => cat.items);
                const bounds = allItems.map(i => [i.lat, i.lng]);
                map.fitBounds(bounds, {padding: [50, 50]});
            }, 100);
        }
    }

    // Init
    renderAssets();
    renderItinerary();

</script>

</body>
</html>